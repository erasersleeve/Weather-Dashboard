<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"/>
    <title>Weather Dashboard</title>
</head>
<body class="container">
    <header class="jumbotron text-center">
        <h1 class="display-3">Weather Dashboard</h1>
    </header>
    
    



    

    <main class="row">    
        <section class= "col-3">
            <table class="table">
                <thead>
                    <tr>
                        <th class="row"scope=col>
                            <div class="col-xs-2">
                                <input class="form-control" placeholder="Enter Location">
                            </div>
                            <div class="col-xs-2">    
                                <button id="searchBtn" class="btn btn-dark">Go</button>
                            </div>
                        </th>
                    </tr>
                </thead>



                <tbody>
                    <tr>
                        <td>Results Here</td>   
                    </tr>
                </tbody>
            </table>
        </section>
        <section class = "col-9">
            <div class="row">
                <div class="card" style="width:85%;">
                    <div class= "daily card-body">
                        <div id="daily-header" class="card-title"></div>
                        <div id="daily-temph" class="card-text"></div>
                        <div id="daily-templ" class="card-text"></div>
                        <div id="daily-humid" class="card-text"></div>
                        <div id="daily-wind" class="card-text"></div>
                        <div id="daily-uv" class="card-text"></div>
                    </div>
                </div>
            </div>
            <div class="row">
                <h2>5-Day Forecast:</h2>
            </div>
            <div class="row">
                <div class="cast0 card" style="width:8rem; margin:10px">
                    <div class="card-body">
                        <div id="cast0-date" class="card-title">Date</div>
                        <div id="cast0-icon" class="card-text">weather forecast icon</div>
                        <div id="cast0-temp" class="card-text">Temperature:</div>
                        <div id="cast0-humid " class="card-text">Humidity:</div>
                    </div>
                </div>
                <div class="cast1 card" style="width:8rem; margin:10px">
                    <div class="card-body">
                        <div id="cast1-date" class="card-title">Date</div>
                        <div id="cast1-icon" class="card-text">weather forecast icon</div>
                        <div id="cast1-temp" class="card-text">Temperature:</div>
                        <div id="cast1-humid " class="card-text">Humidity:</div>
                    </div>
                </div>
                <div class="cast2 card" style="width:8rem; margin:10px">
                    <div class="card-body">
                        <div id="cast2-date" class="card-title">Date</div>
                        <div id="cast2-icon" class="card-text">weather forecast icon</div>
                        <div id="cast2-temp" class="card-text">Temperature:</div>
                        <div id="cast2-humid " class="card-text">Humidity:</div>
                    </div>
                </div>
                <div class="cast3 card" style="width:8rem; margin:10px">
                    <div class="card-body">
                        <div id="cast3-date" class="card-title">Date</div>
                        <div id="cast3-icon" class="card-text">weather forecast icon</div>
                        <div id="cast3-temp" class="card-text">Temperature:</div>
                        <div id="cast3-humid " class="card-text">Humidity:</div>
                    </div>
                </div>
                <div class="cast4 card" style="width:8rem; margin:10px">
                     <div class="card-body">
                        <div id="cast4-date" class="card-title">Date</div>
                        <div id="cast4-icon" class="card-text">weather forecast icon</div>
                        <div id="cast4-temp" class="card-text">Temperature:</div>
                        <div id="cast4-humid " class="card-text">Humidity:</div>
                    </div>
                </div>
            </div>
        </section>
    </main>    


    <footer>

    </footer>
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
    <script type ="text/javascript">
    //on click search the database for the city in the searchbar, return data, and assign data to report locations
//         $("#searchBtn").on("click", function(){

//             var queryURL = "api.openweathermap.org/data/2.5/weather?q={city name}&appid={53f6e5db37a0164708effe3dc2b4c1f5}";
// â€‹
//             $.ajax({
//             url: queryURL,
//             method: "GET"
//             }).then(function(response) {
//             console.log(response);
                    

//         })
            var apiKey ="53f6e5db37a0164708effe3dc2b4c1f5"
            // var queryURL = "https://api.openweathermap.org/data/2.5/weather?q=Philadelphia,Pennsylvania&appid=" +apiKey;
            var lat="39.952584";
            var lon="-75.165221";
            //These below fail and give me a 400 (bad request) every time. Why?
            var cityName = "Philadelphia";       //$("#searchBtn").val
            // var weatherUrl = "https://api.openweathermap.org/data/2.5/weather?q="+cityName+"&appid=" +apiKey;
            //data provided for UV index at 12pm every day.
            var weatherUrl = "https://api.openweathermap.org/data/2.5/onecall?lat="+lat+"&lon="+lon+"&exclude={current,minutely,hourly}&appid="+apiKey;
            
			//format("LL") gets rid of the extra information from momentjs.
			var now = moment().format("LL");
		    
		
         
         
            $("#searchBtn").on("click", function (event){
                $.ajax({
                url: weatherUrl,
                method: "GET"
                }).then(function(weather) {
                console.log(weather);
                console.log("temp high " + weather.daily[0].temp.max);
                console.log("temp min " + weather.daily[0].temp.min);
                console.log("humidity " + weather.daily[0].humidity);
                console.log("wind speed " + weather.daily[0].wind_speed);
                console.log("UV index " + weather.daily[0].uvi)
                console.log("timeStamp "+weather.daily[0].dt)
                
                $("#daily-header").prepend(cityName+" "+now);
                $("#daily-temph").prepend("Temperature High: " +weather.daily[0].temp.max+"K");
                $("#daily-templ").prepend("Temperature Low: " +weather.daily[0].temp.min+"K");
                $("#daily-humid").prepend("Humidity: " +weather.daily[0].humidity+"%");
                $("#daily-wind").prepend("Wind Speed: " +weather.daily[0].wind_speed+"m/s");
                $("#daily-uv").prepend("UV Index: "  +weather.daily[0].uvi);
                var timeStamp = weather.daily[0].dt;
                
                console.log(timeStamp);
               
                })

                
          })   
            
    </script>
    
</body>
</html>